#-------------------- muxiOOOOOauth ------------------------
muxiOOOOOauth:
    build: .
    env_file:
        - muxiOOOOOauth.env
    command: gunicorn --name muxiOOOOOauth -b 0.0.0.0:5486 -w 2 wsgi:app
    ports:
        - "5486:5486"
    volumes:
        - .:/muxiOOOOOauth
    links:
        - redis1

#-------------------- celery --------------------------
celery:
    build: .
    env_file:
        - muxiOOOOOauth.env
    command: celery worker -A restccnu.workers.workers.celery --loglevel=INFO
    volumes:
        - .:/muxiOOOOOauth
    links:
        - redis1
        - redis2

#------------------- redis servers---------------------
redis1:
    image: redis
    command: redis-server --port 6381
    ports:
        - "7381:6381"
redis2:
    image: redis
    command: redis-server --port 6382 # celery result backend
    ports:
        - "7382:6382"
